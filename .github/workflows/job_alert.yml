name: Job Alert Twice Daily

on:
  schedule:
    - cron: '0 9 * * *'   # 9 AM UTC
    - cron: '0 21 * * *'  # 9 PM UTC
  workflow_dispatch:

jobs:
  send_alert:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.x

      - name: Install dependencies
        run: pip install requests

      - name: Run script
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: |
          echo "import os" > job_alert.py
          echo "import requests" >> job_alert.py
          echo "BOT_TOKEN = os.getenv('BOT_TOKEN')" >> job_alert.py
          echo "CHAT_ID = os.getenv('CHAT_ID')" >> job_alert.py
          echo "GOOGLE_SEARCH_LINK = 'https://www.google.com/search?q=(%22Frontend+Developer%22+OR+%22Frontend+Engineer%22)+(%22web3%22+OR+%22blockchain%22)+(%22Remote%22)+(site:greenhouse.io+OR+site:lever.co+OR+site:bamboohr.com+OR+site:workable.com)'" >> job_alert.py
          echo "message = f'ðŸš¨ Web3 Frontend Jobs:\\n{GOOGLE_SEARCH_LINK}'" >> job_alert.py
          echo "def send_telegram_message():" >> job_alert.py
          echo "    url = f'https://api.telegram.org/bot{BOT_TOKEN}/sendMessage'" >> job_alert.py
          echo "    payload = {'chat_id': CHAT_ID, 'text': message}" >> job_alert.py
          echo "    response = requests.post(url, json=payload)" >> job_alert.py
          echo "    print('âœ… Message sent!' if response.ok else f'âŒ Failed: {response.text}')" >> job_alert.py
          echo "send_telegram_message()" >> job_alert.py
          python job_alert.py
